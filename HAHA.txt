# 뉴스·콘텐츠 소스 및 수집 시스템 정리

---

## 개요

| 소스 | 유형 | 수집 방식 | 인증 |
|------|------|-----------|------|
| 유튜브 | 동영상 | API | YOUTUBE_API_KEY 필수 |
| 구글 뉴스 | 기사 | RSS + NewsAPI | NewsAPI 선택 |
| 네이버 뉴스 | 기사 | 스크래핑 + API | Client ID/Secret 선택 |

---

## 검색 흐름 (run_all.py 기준)

  ┌─────────────────────────────────────────────────────────────────┐
  │  1. .env 로드 (프로젝트 루트 기준)                                │
  └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
  ┌─────────────────────────────────────────────────────────────────┐
  │  2. 유튜브 수집 (youtube_scraper.py)                             │
  │     • YouTube Data API v3 → 키워드 검색                           │
  │     • YOUTUBE_API_KEY 필수 (없으면 건너뜀)                         │
  │     • 키워드: 한국 국산화 성공, 일본 패닉, 세계 최초, 국세청 조사 등   │
  │     • 필터: 최근 7일, 조회수 10만 이상                             │
  └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
  ┌─────────────────────────────────────────────────────────────────┐
  │  3. 구글 뉴스 수집 (google_news_scraper.py)                       │
  │     • RSS: 항상 사용 (키 불필요)                                   │
  │     • NewsAPI: NEWS_API_KEY 있으면 추가 호출                       │
  │     • 키워드: 급락, 단독, 최초, 국세청, 폭락                        │
  │     • URL 기준 중복 제거 후 병합                                    │
  └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
  ┌─────────────────────────────────────────────────────────────────┐
  │  4. 네이버 뉴스 수집 (naver_news_scraper.py)                      │
  │     • 스크래핑: 항상 사용 → 경제/사회 '가장 많이 본 뉴스'            │
  │     • API: NAVER_CLIENT_ID + SECRET 있으면 추가 호출               │
  │     • API 키워드: 급락, 단독, 최초, 국세청, 폭락                     │
  │     • URL 기준 중복 제거 후 병합                                    │
  └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
  ┌─────────────────────────────────────────────────────────────────┐
  │  5. 어그로 점수 산출 (aggro_analyzer.py)                          │
  │     • 각 소스별 수집 결과에 keyword_dict 기반 점수 부여              │
  │     • S급×3, A급×2, B급×1.5                                       │
  └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
  ┌─────────────────────────────────────────────────────────────────┐
  │  6. 통합 및 정렬                                                  │
  │     • 유튜브·구글·네이버 → _to_row()로 통일 형식 변환                │
  │     • 추천점수 기준 내림차순 정렬                                   │
  └─────────────────────────────────────────────────────────────────┘
                                    │
                                    ▼
  ┌─────────────────────────────────────────────────────────────────┐
  │  7. 엑셀 출력 (excel_reporter.py)                                 │
  │     • 상위 30건만 출력                                             │
  │     • 컬럼: 순위, 제목, 추천점수, 출처, 유튜브_URL, 뉴스기사_URL 등   │
  └─────────────────────────────────────────────────────────────────┘

---

## 소스별 상세

### 1. 유튜브 (YouTube)

| 항목 | 내용 |
|------|------|
| **방식** | YouTube Data API v3 |
| **인증** | YOUTUBE_API_KEY (필수) |
| **파일** | youtube_scraper.py |
| **키워드** | 한국 국산화 성공, 일본 패닉, 세계 최초, 국세청 조사, 폭락, 몰락 |
| **필터** | 최근 7일, 조회수 10만 이상 |
| **수집 데이터** | 제목, 영상 URL, 조회수, 업로드일 |

### 2. 구글 뉴스 (Google News)

| 항목 | 내용 |
|------|------|
| **RSS** | news.google.com/rss (항상 사용, 무료) |
| **NewsAPI** | newsapi.org (키 있으면 추가) |
| **인증** | NEWS_API_KEY (선택) |
| **파일** | google_news_scraper.py |
| **키워드** | 급락, 단독, 최초, 국세청, 폭락 |
| **수집 데이터** | 제목, 기사 URL, 발행일 |

### 3. 네이버 뉴스 (Naver News)

| 항목 | 내용 |
|------|------|
| **스크래핑** | news.naver.com 랭킹 페이지 (항상 사용) |
| **API** | openapi.naver.com/v1/search/news.json (키 있으면 추가) |
| **인증** | NAVER_CLIENT_ID, NAVER_CLIENT_SECRET (선택) |
| **파일** | naver_news_scraper.py |
| **스크래핑 섹션** | 경제(101), 사회(102) |
| **API 키워드** | 급락, 단독, 최초, 국세청, 폭락 |
| **수집 데이터** | 제목, 기사 URL, 섹션 |

---

## 날짜·기간 기준 (현재 코드 기준)

| 소스 | 기간 필터 | 비고 |
|------|----------|------|
| 유튜브 | **7일** | publishedAfter (DAYS_BACK=7) |
| NewsAPI (구글) | **7일** | from 파라미터 (timedelta 7) |
| 구글 RSS | 없음 | 구글이 반환하는 대로 |
| 네이버 스크래핑 | 없음 | 당일 랭킹 |
| 네이버 API | 없음 | sort=date, 서버 기준 |

엑셀 `업로드일` 컬럼에 유튜브는 publishedAt, 뉴스는 published/pubDate 등 발행일 표기.

---

## API 구조 (작동 조건: .env에 키 설정)

모든 API는 코드상 정상 연동되어 있으며, .env에 해당 키가 설정되면 작동합니다.

### 1. YouTube Data API v3

| 항목 | 값 |
|------|-----|
| **인증** | API Key (쿼리 파라미터 key=) |
| **발급** | Google Cloud Console |
| **환경변수** | YOUTUBE_API_KEY |

**엔드포인트 1: 검색**
- URL: `GET https://www.googleapis.com/youtube/v3/search`
- 파라미터: part=snippet, q={검색어}, type=video, maxResults, publishedAfter, relevanceLanguage=ko, key={API_KEY}
- 반환: videoId 목록 → videos API로 상세 조회

**엔드포인트 2: 영상 상세**
- URL: `GET https://www.googleapis.com/youtube/v3/videos`
- 파라미터: part=snippet,statistics, id={videoId들}, key={API_KEY}
- 반환: 제목, 조회수(viewCount), 업로드일(publishedAt)

---

### 2. NewsAPI.org (구글 뉴스 보조)

| 항목 | 값 |
|------|-----|
| **인증** | API Key (쿼리 파라미터 apiKey=) |
| **발급** | newsapi.org |
| **환경변수** | NEWS_API_KEY |

**엔드포인트**
- URL: `GET https://newsapi.org/v2/everything`
- 파라미터: q={검색어}, apiKey, from={7일전}, sortBy=publishedAt, pageSize
- 반환: articles[] (title, url, publishedAt)

---

### 3. 네이버 검색 API (뉴스)

| 항목 | 값 |
|------|-----|
| **인증** | HTTP 헤더 (X-Naver-Client-Id, X-Naver-Client-Secret) |
| **발급** | developers.naver.com |
| **환경변수** | NAVER_CLIENT_ID, NAVER_CLIENT_SECRET |

**엔드포인트**
- URL: `GET https://openapi.naver.com/v1/search/news.json`
- 헤더: X-Naver-Client-Id, X-Naver-Client-Secret
- 파라미터: query={검색어}, display(1~100), sort=date|sim
- 반환: items[] (title, link, originallink, description, pubDate)

---

### 4. 비-API 소스 (인증 없음)

| 소스 | URL/방식 |
|------|----------|
| 구글 뉴스 RSS | `GET https://news.google.com/rss/search?q=...&hl=ko&gl=KR` |
| 네이버 랭킹 | `GET https://news.naver.com/main/ranking/popularDay.naver?sid1=101|102` (HTML 스크래핑) |

---

## 5. 어그로 점수 산출 (공통)

| 항목 | 내용 |
|------|------|
| **파일** | aggro_analyzer.py, keyword_dict.py |
| **가중치** | S급×3, A급×2, B급×1.5 |

### 추천점수 키워드 사전 (총 118개)

| 등급 | 가중치 | 카테고리 | 키워드 |
|------|--------|----------|--------|
| **S** | ×3 | 국뽕/경탄 | 세계 최초, 외신 발칵, 인류 역사상, 미 연구진 경악, 일본 침묵, 전 세계가 떨고 있다, 압도적 1위, 기적의 기술, 한국만 가능, 단독, 국산화 성공, 일본 패닉, 미국도 경악, 압도적, 주도권, 전 세계 3번째, 전 세계 유일, 미국이 매달리는, 반도체 전쟁 종결, 독점권 확보, ASML도 경악, 한국 없으면 마비, 기술 격차 50년, 인류 구원, 천문학적 로열티 |
| **S** | ×3 | 공포/위기 | 지옥문 열렸다, 시한폭탄, 전액 손실, 영끌족의 비명, 99%가 모르는, 삭제되기 전에, 처참한 몰락, 유령도시, 시신 없는 살인, 몰락, 처처함, 파산, 붕괴, 실체, 충격적 진실, 배신, 끝장, 폭락, 마지막 경고, 전부 도망치세요, 이미 늦었습니다, 골든타임 끝, 자살골, 국가 부도 징후, 제2의 IMF, 한국판 잃어버린 30년, 전멸, 생존 확률 0% |
| **A** | ×2 | 기관/인물 | 국세청 조사 3국, 국세청, 조사 3국, 특허청 단독, 하버드 박사, 삼성전자 내부, 현대차 비밀 프로젝트, IMF 경고, 월스트리트 분석, 오너 일가, 대통령실 비상, 금감원 긴급, 국정원 기밀, 골드만삭스 보고서, 내부 고발자, 화이트 해커, 재벌 3세의 만행, 월가 거물의 예언 |
| **A** | ×2 | 진실 폭로 | 가면을 벗긴, 일감 몰아주기, 비자금 세탁, 실체 공개, 쇠창살 엔딩, 법인카드 유용, 33년 성역, 차명 계좌, 비밀, 폭로, 뒤집힌 결과, 숫자는 거짓말 안 함, 분식회계 100조, 뒷배의 정체, 설마 했는데 역시나, 유출된 녹취록, 금지된 영상, 보도 통제 해제, 판도라의 상자, 조작된 데이터 |
| **B** | ×1.5 | 경제/생활 | 중고차 시장 속출, 카푸어의 눈물, 깡통 전세, 폐업 속출, 명품 중고, 강남 중산층, 은퇴 자금, 무주택자 분노, 인구 소멸, 지방 멸망, 상속세 폭탄, 국민연금 고갈, 강남 아파트 투매, 마이너스 통장의 비명, 식량 위기, 전기료 폭등 |
| **B** | ×1.5 | 비교/대비 | 일본의 열등감, 중국의 추격 실패, 대만 굴복, 유럽도 포기한, 테슬라 압도, 중국 반도체 굴기 사망, 도요타의 절망, 독일차의 항복, 베트남의 배신, 인도의 추격 실패, EU의 러브콜 |

---

최종 수정: 2025-02-02
